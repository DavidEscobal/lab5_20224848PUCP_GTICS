<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Enviar mensaje</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script>
        function toggleColor(){
            const tipo = document.getElementById('tipo').value;
            document.getElementById('colorGroup').style.display = (tipo === 'Carrito') ? 'block' : 'none';
        }
    </script>
</head>
<body onload="toggleColor()">
<div th:replace="fragments/navbar :: navbar"></div>

<div class="container mt-4">
    <h3>Enviar mensaje</h3>

    <form th:action="@{/mensajes/enviar}" th:object="${mensaje}" method="post">
        <div class="form-group">
            <label>Destinatario</label>
            <select class="form-control" th:field="*{destinatario.id}">
                <option th:each="u : ${usuarios}"
                        th:value="${u.id}"
                        th:text="${u.nombre + ' ' + u.apellido}">
                </option>
            </select>
            <div class="text-danger" th:errors="*{destinatario}"></div>
        </div>

        <div class="form-group">
            <label>Remitente</label>
            <select class="form-control" th:field="*{remitente.id}">
                <option th:each="u : ${usuarios}"
                        th:value="${u.id}"
                        th:text="${u.nombre + ' ' + u.apellido}">
                </option>
            </select>
            <div class="text-danger" th:errors="*{remitente}"></div>
        </div>

        <div class="form-group">
            <label>Regalo</label>
            <select id="tipo" th:field="*{regaloTipo}" class="form-control" onchange="toggleColor()">
                <!-- Si usas enum: value="Flor"/"Carrito"; si usas String, igual -->
                <option value="Flor">Flor amarilla</option>
                <option value="Carrito">Carrito (elegir color)</option>
            </select>
            <div class="text-danger" th:errors="*{regaloTipo}"></div>
        </div>

        <div class="form-group" id="colorGroup" style="display:none">
            <label>Color (solo carrito)</label>
            <input th:field="*{regaloColor}" class="form-control" placeholder="rojo, azul, ...">
            <div class="text-danger" th:errors="*{regaloColor}"></div>
        </div>

        <div class="form-group">
            <label>Contenido</label>
            <textarea th:field="*{contenido}" class="form-control" rows="4" placeholder="MÃ­nimo 20 caracteres"></textarea>
            <div class="text-danger" th:errors="*{contenido}"></div>
        </div>

        <button class="btn btn-primary">Enviar</button>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
